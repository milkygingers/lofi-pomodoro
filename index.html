<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cassette Pomodoro Timer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Google Font for the retro text -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />

  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    function CassettePomodoro() {
      const [minutes, setMinutes] = React.useState(25);
      const [seconds, setSeconds] = React.useState(0);
      const [isActive, setIsActive] = React.useState(false);
      const [mode, setMode] = React.useState('work');
      const [session, setSession] = React.useState(1);
      const [totalSessions] = React.useState(4);
      const [rotation, setRotation] = React.useState(0);

      const audioRef = React.useRef(null);

      React.useEffect(() => {
        let interval = null;

        if (isActive) {
          interval = setInterval(() => {
            setRotation(prev => prev + 10);

            if (seconds === 0) {
              if (minutes === 0) {
                clearInterval(interval);
                setIsActive(false);
                handleTimerComplete();
              } else {
                setMinutes(prev => prev - 1);
                setSeconds(59);
              }
            } else {
              setSeconds(prev => prev - 1);
            }
          }, 1000);
        } else if (!isActive && interval) {
          clearInterval(interval);
        }

        return () => clearInterval(interval);
      }, [isActive, minutes, seconds]);

      const handleTimerComplete = () => {
        if (audioRef.current) {
          audioRef.current.play().catch(e => console.log('Audio play failed:', e));
        }

        if (mode === 'work') {
          if (session === totalSessions) {
            setMode('longBreak');
            setMinutes(15);
            setSeconds(0);
            setSession(1);
          } else {
            setMode('break');
            setMinutes(5);
            setSeconds(0);
            setSession(session + 1);
          }
        } else {
          setMode('work');
          setMinutes(25);
          setSeconds(0);
        }
      };

      const toggleTimer = () => {
        setIsActive(!isActive);
      };

      const resetTimer = () => {
        setIsActive(false);
        if (mode === 'work') {
          setMinutes(25);
        } else if (mode === 'break') {
          setMinutes(5);
        } else {
          setMinutes(15);
        }
        setSeconds(0);
      };

      const skipSession = () => {
        setIsActive(false);
        handleTimerComplete();
      };

      return (
        <div style={{
          minHeight: '20vh',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          background: 'transparent',
          fontFamily: '"Press Start 2P", monospace'
        }}>

          <div style={{ position: 'relative' }}>
            <div style={{
              position: 'absolute',
              inset: 0,
              opacity: 0.3,
              filter: 'blur(3rem)',
              transform: 'translateY(1rem)'
            }}></div>

            {/* Cassette Body */}
            <div style={{
              position: 'relative',
              background: 'linear-gradient(135deg, #d8daff 0%, #ff9ed8 100%)',
              width: '500px',
              height: '320px',
              borderRadius: '12px',
              boxShadow: '0 8px 32px rgba(0,0,0,0.2), inset 0 -4px 8px rgba(0,0,0,0.1)',
              border: '4px solid #7b2cbf',
              overflow: 'hidden'
            }}>
              {/* Top label area */}
              <div style={{
                background: 'linear-gradient(180deg, #ffd6e8 0%, #ffe8f0 100%)',
                height: '60px',
                borderBottom: '3px solid #7b2cbf',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                padding: '0 2rem',
                position: 'relative'
              }}>
                <div style={{
                  fontSize: '0.7rem',
                  color: '#5a189a',
                  letterSpacing: '0.1em',
                  textTransform: 'uppercase'
                }}>
                  {mode === 'work' ? ' WORK TIME' : mode === 'break' ? '‚òï BREAK' : 'üåü LONG BREAK'}
                </div>

                {/* Screws */}
                {[0, 1].map(i => (
                  <div key={i} style={{
                    position: 'absolute',
                    [i === 0 ? 'left' : 'right']: '1rem',
                    width: '12px',
                    height: '12px',
                    borderRadius: '50%',
                    background: '#c77dff',
                    border: '2px solid #9d4edd',
                    boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.2)'
                  }}>
                    <div style={{
                      position: 'absolute',
                      top: '50%',
                      left: '50%',
                      transform: 'translate(-50%, -50%)',
                      width: '6px',
                      height: '1px',
                      background: '#5a189a'
                    }}></div>
                  </div>
                ))}
              </div>

              {/* Main cassette area */}
              <div style={{
                padding: '1rem',
                display: 'flex',
                flexDirection: 'column',
                height: 'calc(100% - 60px)'
              }}>
                {/* Reels and window */}
                <div style={{
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                  marginBottom: '1.5rem',
                  gap: '1.5rem'
                }}>
                  {/* Left Reel */}
                  <div style={{
                    width: '90px',
                    height: '90px',
                    borderRadius: '50%',
                    background: '#240046',
                    border: '4px solid #5a189a',
                    position: 'relative',
                    boxShadow: 'inset 0 4px 8px rgba(0,0,0,0.3), 0 2px 8px rgba(0,0,0,0.2)',
                    transform: `rotate(${rotation}deg)`,
                    transition: 'transform 0.3s linear'
                  }}>
                    {[0, 60, 120, 180, 240, 300].map(angle => (
                      <div key={angle} style={{
                        position: 'absolute',
                        top: '50%',
                        left: '50%',
                        width: '30px',
                        height: '4px',
                        background: '#7b2cbf',
                        transformOrigin: 'left center',
                        transform: `rotate(${angle}deg)`
                      }}></div>
                    ))}
                    <div style={{
                      position: 'absolute',
                      top: '50%',
                      left: '50%',
                      transform: 'translate(-50%, -50%)',
                      width: '24px',
                      height: '24px',
                      borderRadius: '50%',
                      background: '#10002b',
                      border: '2px solid #3c096c'
                    }}></div>
                  </div>

                  {/* Timer Window */}
                  <div style={{
                    flex: 1,
                    background: 'rgba(36, 0, 70, 0.6)',
                    borderRadius: '8px',
                    padding: '1.5rem',
                    border: '3px solid #5a189a',
                    boxShadow: 'inset 0 4px 8px rgba(0,0,0,0.4)',
                    backdropFilter: 'blur(10px)'
                  }}>
                    <div style={{
                      textAlign: 'center',
                      fontSize: '3rem',
                      fontWeight: 'bold',
                      color: '#06ffa5',
                      fontFamily: '"Courier New", monospace',
                      textShadow: '0 0 20px rgba(6, 255, 165, 0.6), 0 2px 4px rgba(0,0,0,0.8)',
                      letterSpacing: '0.1em'
                    }}>
                      {String(minutes).padStart(2, '0')}:{String(seconds).padStart(2, '0')}
                    </div>
                  </div>

                  {/* Right Reel */}
                  <div style={{
                    width: '90px',
                    height: '90px',
                    borderRadius: '50%',
                    background: '#240046',
                    border: '4px solid #5a189a',
                    position: 'relative',
                    boxShadow: 'inset 0 4px 8px rgba(0,0,0,0.3), 0 2px 8px rgba(0,0,0,0.2)',
                    transform: `rotate(${-rotation}deg)`,
                    transition: 'transform 0.3s linear'
                  }}>
                    {[0, 60, 120, 180, 240, 300].map(angle => (
                      <div key={angle} style={{
                        position: 'absolute',
                        top: '50%',
                        left: '50%',
                        width: '30px',
                        height: '4px',
                        background: '#7b2cbf',
                        transformOrigin: 'left center',
                        transform: `rotate(${angle}deg)`
                      }}></div>
                    ))}
                    <div style={{
                      position: 'absolute',
                      top: '50%',
                      left: '50%',
                      transform: 'translate(-50%, -50%)',
                      width: '24px',
                      height: '24px',
                      borderRadius: '50%',
                      background: '#10002b',
                      border: '2px solid #3c096c'
                    }}></div>
                  </div>
                </div>

                {/* Session indicator */}
                <div style={{
                  display: 'flex',
                  justifyContent: 'center',
                  gap: '0.5rem',
                  marginBottom: '1rem'
                }}>
                  {[...Array(totalSessions)].map((_, i) => (
                    <div key={i} style={{
                      width: '28px',
                      height: '8px',
                      borderRadius: '4px',
                      background: i < (mode === 'work' ? session - 1 : session) ? '#06ffa5' : 'rgba(255, 255, 255, 0.3)',
                      boxShadow: i < (mode === 'work' ? session - 1 : session) ? '0 0 10px rgba(6, 255, 165, 0.6)' : 'none',
                      border: '2px solid #5a189a',
                      transition: 'all 0.3s'
                    }}></div>
                  ))}
                </div>

                {/* Control Buttons */}
                <div style={{
                  display: 'flex',
                  gap: '0.75rem',
                  justifyContent: 'center'
                }}>
                  <button onClick={toggleTimer} style={{
                    background: 'linear-gradient(180deg, #ffd6e8 0%, #ffb3d9 100%)',
                    border: '3px solid #7b2cbf',
                    borderRadius: '8px',
                    padding: '0.75rem 1.5rem',
                    fontSize: '0.6rem',
                    fontWeight: 'bold',
                    color: '#5a189a',
                    cursor: 'pointer',
                    boxShadow: '0 4px 0 #5a189a, 0 6px 8px rgba(0,0,0,0.2)',
                    transition: 'all 0.1s',
                    fontFamily: '"Press Start 2P", monospace',
                    textTransform: 'uppercase',
                    letterSpacing: '0.05em'
                  }}
                  onMouseDown={(e) => {
                    e.target.style.transform = 'translateY(2px)';
                    e.target.style.boxShadow = '0 2px 0 #5a189a, 0 4px 6px rgba(0,0,0,0.2)';
                  }}
                  onMouseUp={(e) => {
                    e.target.style.transform = 'translateY(0)';
                    e.target.style.boxShadow = '0 4px 0 #5a189a, 0 6px 8px rgba(0,0,0,0.2)';
                  }}>
                    {isActive ? '‚è∏ PAUSE' : '‚ñ∂ START'}
                  </button>

                  <button onClick={resetTimer} style={{
                    background: 'linear-gradient(180deg, #ffd6e8 0%, #ffb3d9 100%)',
                    border: '3px solid #7b2cbf',
                    borderRadius: '8px',
                    padding: '0.75rem 1.25rem',
                    fontSize: '0.6rem',
                    fontWeight: 'bold',
                    color: '#5a189a',
                    cursor: 'pointer',
                    boxShadow: '0 4px 0 #5a189a, 0 6px 8px rgba(0,0,0,0.2)',
                    transition: 'all 0.1s',
                    fontFamily: '"Press Start 2P", monospace',
                    textTransform: 'uppercase'
                  }}
                  onMouseDown={(e) => {
                    e.target.style.transform = 'translateY(2px)';
                    e.target.style.boxShadow = '0 2px 0 #5a189a, 0 4px 6px rgba(0,0,0,0.2)';
                  }}
                  onMouseUp={(e) => {
                    e.target.style.transform = 'translateY(0)';
                    e.target.style.boxShadow = '0 4px 0 #5a189a, 0 6px 8px rgba(0,0,0,0.2)';
                  }}>
                    ‚Üª RESET
                  </button>

                  <button onClick={skipSession} style={{
                    background: 'linear-gradient(180deg, #ffd6e8 0%, #ffb3d9 100%)',
                    border: '3px solid #7b2cbf',
                    borderRadius: '8px',
                    padding: '0.75rem 1.25rem',
                    fontSize: '0.6rem',
                    fontWeight: 'bold',
                    color: '#5a189a',
                    cursor: 'pointer',
                    boxShadow: '0 4px 0 #5a189a, 0 6px 8px rgba(0,0,0,0.2)',
                    transition: 'all 0.1s',
                    fontFamily: '"Press Start 2P", monospace',
                    textTransform: 'uppercase'
                  }}
                  onMouseDown={(e) => {
                    e.target.style.transform = 'translateY(2px)';
                    e.target.style.boxShadow = '0 2px 0 #5a189a, 0 4px 6px rgba(0,0,0,0.2)';
                  }}
                  onMouseUp={(e) => {
                    e.target.style.transform = 'translateY(0)';
                    e.target.style.boxShadow = '0 4px 0 #5a189a, 0 6px 8px rgba(0,0,0,0.2)';
                  }}>
                    ‚è≠ SKIP
                  </button>
                </div>
              </div>

              {/* Bottom screws */}
              {[0, 1, 2, 3].map(i => (
                <div key={i} style={{
                  position: 'absolute',
                  bottom: '1rem',
                  [i < 2 ? 'left' : 'right']: i % 2 === 0 ? '1rem' : '3.5rem',
                  width: '10px',
                  height: '10px',
                  borderRadius: '50%',
                  background: '#c77dff',
                  border: '2px solid #9d4edd',
                  boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.2)'
                }}>
                  <div style={{
                    position: 'absolute',
                    top: '50%',
                    left: '50%',
                    transform: 'translate(-50%, -50%)',
                    width: '5px',
                    height: '1px',
                    background: '#5a189a'
                  }}></div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<CassettePomodoro />);
  </script>
</body>
</html>
